---
:values:
- id: "./cost/aws/old_snapshots/aws_delete_old_snapshots.pt"
  name: AWS Old Snapshots
  version: '7.5'
  :providers:
  - :name: aws
    :permissions:
    - name: ec2:DescribeRegions
      read_only: true
      required: true
    - name: ec2:DescribeImages
      read_only: true
      required: true
    - name: ec2:DescribeSnapshots
      read_only: true
      required: true
    - name: ec2:DeregisterImage
      read_only: false
      required: false
      description: Only required for taking action (deletion); the policy will still
        function in a read-only capacity without these permissions.
    - name: ec2:DeleteSnapshot
      read_only: false
      required: false
      description: Only required for taking action (deletion); the policy will still
        function in a read-only capacity without these permissions.
    - name: rds:DescribeDBInstances
      read_only: true
      required: true
    - name: rds:DescribeDBSnapshots
      read_only: true
      required: true
    - name: rds:DescribeDBClusters
      read_only: true
      required: true
    - name: rds:DescribeDBClusterSnapshots
      read_only: true
      required: true
    - name: rds:DeleteDBClusterSnapshot
      read_only: false
      required: false
      description: Only required for taking action (deletion); the policy will still
        function in a read-only capacity without these permissions.
    - name: rds:DeleteDBSnapshot
      read_only: false
      required: false
      description: Only required for taking action (deletion); the policy will still
        function in a read-only capacity without these permissions.
    - name: sts:GetCallerIdentity
      read_only: true
      required: true
    - name: cloudtrail:LookupEvents
      read_only: true
      required: true
  - :name: flexera
    :permissions:
    - name: billing_center_viewer
      read_only: true
      required: true
