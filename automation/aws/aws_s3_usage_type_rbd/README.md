# AWS S3 Usage Type Rule-Based Dimension

## What It Does

This policy template creates and updates a custom Rule-Based Dimension for S3 usage types. This rule-based dimension will contain more general, human-readable usage types than the built-in `Usage Type` dimension that comes with the Flexera One platform.

## How It Works

- A full list of all `usage_type` dimension values for AWS S3 for the last 12 months is pulled from the Flexera CCO platform via the [Flexera Bill Analysis API](https://reference.rightscale.com/bill_analysis/#/costs/costs_aggregated)
- Each value is then analyzed to determine what value the new Rule-Based Dimension should have. For example, if the `usage_type` value contains the substring "-CloudFront", the value of the Rule-Based Dimension will be set to "CloudFront"
- A set of rules are generated based on the above and the new Rule-Based Dimension is created/updated via the [FinOps Customizations API](https://developer.flexera.com/docs/api/finops-customizations/v1)

## Input Parameters

This policy has the following input parameters required when launching the policy.

- *Effective Date* - The month and year in YYYY-MM format that you want the rules to apply. This should be left at its default value in most cases to ensure that the rules apply to all costs, including historical costs.
- *Rule-Based Dimension ID* - The ID of the Rule-Based Dimension to create/update. ID must begin with `rbd_` and contain only lowercase letters, numbers, and underscores. *Note that, if a Rule-Based Dimension with the specified ID already exists, this policy template will overwrite its name and rules with the ones generated by this policy template.*
- *Rule-Based Dimension Name* -The Name of the Rule-Based Dimension to create/update.

## Policy Actions

- Create/update rule-based dimension

## Prerequisites

This Policy Template uses [Credentials](https://docs.flexera.com/flexera/EN/Automation/ManagingCredentialsExternal.htm) for authenticating to datasources -- in order to apply this policy you must have a Credential registered in the system that is compatible with this policy. If there are no Credentials listed when you apply the policy, please contact your Flexera Org Admin and ask them to register a Credential that is compatible with this policy. The information below should be consulted when creating the credential(s).

- [**Flexera Credential**](https://docs.flexera.com/flexera/EN/Automation/ProviderCredentials.htm) (*provider=flexera*) which has the following roles:
  - `observer`
  - `billing_center_viewer`
  - `rule_based_dimensions_manager`

The [Provider-Specific Credentials](https://docs.flexera.com/flexera/EN/Automation/ProviderCredentials.htm) page in the docs has detailed instructions for setting up Credentials for the most common providers.

## Supported Clouds

- AWS

## Cost

This policy template does not incur any cloud costs.
