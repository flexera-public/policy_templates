# Oracle Cloud Advisor: Rightsize Virtual Machines

## What It Does

This policy template reports on any existing underutilized virtual machine recommendations generated by Oracle Cloud Advisor. Optionally, this report can be emailed.

### How It Works

This policy template reports the following Oracle Cloud Advisor recommendations:

- `cost-management-compute-host-underutilized-desc`: Checks if a virtual machine is underutilized and recommends a more appropriate machine type when appropriate.

More information is available in Oracle's documentation:

- [About Cloud Advisor](https://docs.public.oneportal.content.oci.oraclecloud.com/en-us/iaas/Content/CloudAdvisor/Concepts/cloudadvisoroverview.htm)
- [Getting Started with Cloud Advisor](https://docs.oracle.com/en-us/iaas/Content/CloudAdvisor/Tasks/cloudadvisor-getting_started.htm)

### Policy Savings Details

The policy includes the estimated monthly savings. The estimated monthly savings is recognized for underutilized resources if the resource is downsized.

- The `Estimated Monthly Savings` is obtained directly from the Oracle Cloud Advisor service.
- Since the savings estimates are obtained directly from Oracle, they will take into account any cloud provider discounts but *not* any Flexera adjustment rules or other cost manipulations specific to the Flexera platform.
- The incident message detail includes the sum of each resource `Estimated Monthly Savings` as `Potential Monthly Savings`.

## Input Parameters

- *Email Addresses* - Email addresses of the recipients you wish to notify.
- *Minimum Savings Threshold* - Minimum potential savings required to generate a recommendation.
- *Oracle Cloud Root Compartment OCID* - The OCID of the Oracle Cloud root compartment.
- *Primary Oracle Cloud Region* - Primary Oracle Cloud region. Example: us-phoenix-1

## Policy Actions

The following policy actions are taken on any resources found to be out of compliance.

- Send an email report

## Prerequisites

This Policy Template uses [Credentials](https://docs.flexera.com/flexera/EN/Automation/ManagingCredentialsExternal.htm) for authenticating to datasources -- in order to apply this policy you must have a Credential registered in the system that is compatible with this policy. If there are no Credentials listed when you apply the policy, please contact your Flexera Org Admin and ask them to register a Credential that is compatible with this policy. The information below should be consulted when creating the credential(s).

- [**Oracle Credential**](https://docs.flexera.com/flexera/EN/Automation/ProviderCredentials.htm#automationadmin_3335267112_1121578) (*provider=oracle*) which meets the below requirements:
  - Allow group [Group] to read optimizer-api-family in tenancy
    - [Group] should be replaced with a group that the user associated with the Oracle Cloud credential is a member of.

- [**Flexera Credential**](https://docs.flexera.com/flexera/EN/Automation/ProviderCredentials.htm) (*provider=flexera*) which has the following roles:
  - `billing_center_viewer`

The [Provider-Specific Credentials](https://docs.flexera.com/flexera/EN/Automation/ProviderCredentials.htm) page in the docs has detailed instructions for setting up Credentials for the most common providers.

Additionally, this Policy Template requires that [Oracle Cloud Advisor be enabled](https://docs.oracle.com/en-us/iaas/Content/CloudAdvisor/Tasks/cloudadvisor-getting_started.htm) in your Oracle Cloud environment.

## Supported Clouds

- Oracle

## Cost

This policy template does not incur any cloud costs.
